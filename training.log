2025-07-20 21:26:30,441 - __main__ - INFO - ============================================================
2025-07-20 21:26:30,445 - __main__ - INFO - Loading M5 competition data...
2025-07-20 21:26:30,446 - __main__ - ERROR - Error loading data: M5 data files not found. Please ensure data is in data/raw/
2025-07-20 21:26:30,451 - __main__ - ERROR - Training failed: M5 data files not found. Please ensure data is in data/raw/
2025-07-20 21:29:38,662 - __main__ - INFO - ============================================================
2025-07-20 21:29:38,665 - __main__ - INFO - Loading M5 competition data...
2025-07-20 21:29:38,665 - __main__ - ERROR - Error loading data: M5 data files not found. Please ensure data is in data/raw/
2025-07-20 21:29:38,673 - __main__ - ERROR - Training failed: M5 data files not found. Please ensure data is in data/raw/
2025-07-20 21:30:00,138 - __main__ - INFO - Starting M5 Demand Forecasting Training Pipeline
2025-07-20 21:30:00,139 - __main__ - INFO - ============================================================
2025-07-20 21:30:00,139 - __main__ - INFO - Step 1: Loading data...
2025-07-20 21:30:00,139 - __main__ - INFO - Loading M5 competition data...
2025-07-20 21:30:00,140 - __main__ - INFO - Found data files in: src\data\raw
2025-07-20 21:30:00,140 - __main__ - INFO - Loading sales data...
2025-07-20 21:30:02,546 - __main__ - INFO - Converting sales data to long format...
2025-07-20 21:31:00,013 - __main__ - INFO - Loading calendar and prices data...
2025-07-20 21:31:01,746 - __main__ - INFO - Data loaded successfully!
2025-07-20 21:31:01,747 - __main__ - INFO - Sales shape: (58327370, 9)
2025-07-20 21:31:01,747 - __main__ - INFO - Calendar shape: (1969, 14)
2025-07-20 21:31:01,748 - __main__ - INFO - Prices shape: (6841121, 4)
2025-07-20 21:31:01,776 - __main__ - INFO - Step 2: Creating features...
2025-07-20 21:31:01,776 - __main__ - INFO - Creating features...
2025-07-20 21:31:01,777 - __main__ - INFO - Quick test mode - using subset of data
2025-07-20 21:31:02,274 - features.feature_engineering - INFO - Creating comprehensive feature set...
2025-07-20 21:31:02,279 - features.feature_engineering - INFO - Merging calendar data...
2025-07-20 21:31:02,327 - features.feature_engineering - INFO - Merging pricing data...
2025-07-20 21:31:03,696 - features.feature_engineering - INFO - Creating temporal features...
2025-07-20 21:31:03,751 - features.feature_engineering - INFO - Creating lag features...
2025-07-20 21:31:18,244 - features.feature_engineering - INFO - Creating rolling window features...
2025-07-20 21:31:18,967 - features.feature_engineering - INFO - Creating demand pattern features...
2025-07-20 21:32:46,792 - features.feature_engineering - INFO - Creating price features...
2025-07-20 21:32:47,109 - features.feature_engineering - INFO - Creating categorical features...
2025-07-20 21:32:47,290 - features.feature_engineering - INFO - Creating business logic features...
2025-07-20 21:33:21,503 - features.feature_engineering - INFO - Creating interaction features...
2025-07-20 21:33:21,593 - features.feature_engineering - INFO - Creating event features...
2025-07-20 21:33:21,800 - features.feature_engineering - INFO - Feature engineering complete. Shape: (101000, 134)
2025-07-20 21:33:21,800 - __main__ - INFO - Features created. Shape: (101000, 134)
2025-07-20 21:33:28,420 - __main__ - INFO - Features saved to data\features\feature_store.csv
2025-07-20 21:33:28,424 - __main__ - INFO - Step 3: Splitting data...
2025-07-20 21:33:28,425 - __main__ - INFO - Splitting data for time series validation...
2025-07-20 21:33:28,616 - __main__ - INFO - Data split completed:
2025-07-20 21:33:28,617 - __main__ - INFO -   Train: (45000, 134) (2016-01-15 00:00:00 to 2016-02-28 00:00:00)
2025-07-20 21:33:28,618 - __main__ - INFO -   Val:   (28000, 134) (2016-02-29 00:00:00 to 2016-03-27 00:00:00)
2025-07-20 21:33:28,619 - __main__ - INFO -   Test:  (28000, 134) (2016-03-28 00:00:00 to 2016-04-24 00:00:00)
2025-07-20 21:33:28,630 - __main__ - INFO - Step 4: Preparing model data...
2025-07-20 21:33:28,631 - __main__ - INFO - Preparing data for modeling...
2025-07-20 21:33:28,631 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:33:28,845 - features.feature_engineering - INFO - Final feature set: 124 features
2025-07-20 21:33:28,845 - features.feature_engineering - INFO - Features: day_num, weekday, wday, month, year, event_name_1, event_type_1, event_name_2, event_type_2, snap_CA...
2025-07-20 21:33:28,846 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:33:28,974 - features.feature_engineering - INFO - Final feature set: 124 features
2025-07-20 21:33:28,974 - features.feature_engineering - INFO - Features: day_num, weekday, wday, month, year, event_name_1, event_type_1, event_name_2, event_type_2, snap_CA...
2025-07-20 21:33:28,974 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:33:29,110 - features.feature_engineering - INFO - Final feature set: 124 features
2025-07-20 21:33:29,111 - features.feature_engineering - INFO - Features: day_num, weekday, wday, month, year, event_name_1, event_type_1, event_name_2, event_type_2, snap_CA...
2025-07-20 21:33:29,111 - __main__ - INFO - Model data prepared:
2025-07-20 21:33:29,111 - __main__ - INFO -   Features: 124
2025-07-20 21:33:29,112 - __main__ - INFO -   Train samples: 45000
2025-07-20 21:33:29,112 - __main__ - INFO -   Val samples: 28000
2025-07-20 21:33:29,112 - __main__ - INFO -   Test samples: 28000
2025-07-20 21:33:29,113 - __main__ - INFO - Step 5: Training models...
2025-07-20 21:33:29,113 - __main__ - INFO - Training models: ['lightgbm', 'xgboost']
2025-07-20 21:33:29,113 - __main__ - INFO - Training lightgbm...
2025-07-20 21:33:29,113 - models.ml_models - INFO - Training lightgbm...
2025-07-20 21:33:29,114 - models.ml_models - INFO - Training lightgbm with shape (45000, 124)
2025-07-20 21:33:29,118 - __main__ - ERROR - Pipeline failed: pandas dtypes must be int, float or bool.
Fields with bad pandas dtypes: weekday: object, event_name_1: object, event_type_1: object, state_cat: object, store_cat: object, store_dept: object
2025-07-20 21:33:29,118 - __main__ - ERROR - Training failed: pandas dtypes must be int, float or bool.
Fields with bad pandas dtypes: weekday: object, event_name_1: object, event_type_1: object, state_cat: object, store_cat: object, store_dept: object
2025-07-20 21:36:43,345 - __main__ - INFO - Starting M5 Demand Forecasting Training Pipeline
2025-07-20 21:36:43,345 - __main__ - INFO - ============================================================
2025-07-20 21:36:43,345 - __main__ - INFO - Step 1: Loading data...
2025-07-20 21:36:43,346 - __main__ - INFO - Loading M5 competition data...
2025-07-20 21:36:43,346 - __main__ - INFO - Found data files in: src\data\raw
2025-07-20 21:36:43,347 - __main__ - INFO - Loading sales data...
2025-07-20 21:36:45,965 - __main__ - INFO - Converting sales data to long format...
2025-07-20 21:37:43,032 - __main__ - INFO - Loading calendar and prices data...
2025-07-20 21:37:44,811 - __main__ - INFO - Data loaded successfully!
2025-07-20 21:37:44,811 - __main__ - INFO - Sales shape: (58327370, 9)
2025-07-20 21:37:44,811 - __main__ - INFO - Calendar shape: (1969, 14)
2025-07-20 21:37:44,812 - __main__ - INFO - Prices shape: (6841121, 4)
2025-07-20 21:37:44,830 - __main__ - INFO - Step 2: Creating features...
2025-07-20 21:37:44,830 - __main__ - INFO - Creating features...
2025-07-20 21:37:44,830 - __main__ - INFO - Quick test mode - using subset of data
2025-07-20 21:37:45,352 - features.feature_engineering - INFO - Creating comprehensive feature set...
2025-07-20 21:37:45,359 - features.feature_engineering - INFO - Merging calendar data...
2025-07-20 21:37:45,559 - features.feature_engineering - INFO - Merging pricing data...
2025-07-20 21:37:47,086 - features.feature_engineering - INFO - Creating temporal features...
2025-07-20 21:37:47,135 - features.feature_engineering - INFO - Creating lag features...
2025-07-20 21:38:02,949 - features.feature_engineering - INFO - Creating rolling window features...
2025-07-20 21:38:03,680 - features.feature_engineering - INFO - Creating demand pattern features...
2025-07-20 21:39:29,547 - features.feature_engineering - INFO - Creating price features...
2025-07-20 21:39:29,830 - features.feature_engineering - INFO - Creating categorical features...
2025-07-20 21:39:30,212 - features.feature_engineering - INFO - Creating business logic features...
2025-07-20 21:40:01,614 - features.feature_engineering - INFO - Creating interaction features...
2025-07-20 21:40:01,727 - features.feature_engineering - INFO - Creating event features...
2025-07-20 21:40:01,850 - features.feature_engineering - INFO - Feature engineering complete. Shape: (101000, 132)
2025-07-20 21:40:01,850 - __main__ - INFO - Features created. Shape: (101000, 132)
2025-07-20 21:40:07,418 - __main__ - INFO - Features saved to data\features\feature_store.csv
2025-07-20 21:40:07,420 - __main__ - INFO - Step 3: Splitting data...
2025-07-20 21:40:07,421 - __main__ - INFO - Splitting data for time series validation...
2025-07-20 21:40:07,604 - __main__ - INFO - Data split completed:
2025-07-20 21:40:07,605 - __main__ - INFO -   Train: (45000, 132) (2016-01-15 00:00:00 to 2016-02-28 00:00:00)
2025-07-20 21:40:07,606 - __main__ - INFO -   Val:   (28000, 132) (2016-02-29 00:00:00 to 2016-03-27 00:00:00)
2025-07-20 21:40:07,607 - __main__ - INFO -   Test:  (28000, 132) (2016-03-28 00:00:00 to 2016-04-24 00:00:00)
2025-07-20 21:40:07,616 - __main__ - INFO - Step 4: Preparing model data...
2025-07-20 21:40:07,616 - __main__ - INFO - Preparing data for modeling...
2025-07-20 21:40:07,617 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:40:07,776 - features.feature_engineering - INFO - Final feature set: 122 features
2025-07-20 21:40:07,776 - features.feature_engineering - INFO - Features: day_num, wday, month, year, snap_CA, snap_TX, snap_WI, weekday_encoded, event_name_1_encoded, event_type_1_encoded...
2025-07-20 21:40:07,777 - features.feature_engineering - INFO - Data types: {dtype('float32'): 122}
2025-07-20 21:40:07,777 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:40:07,902 - features.feature_engineering - INFO - Final feature set: 122 features
2025-07-20 21:40:07,902 - features.feature_engineering - INFO - Features: day_num, wday, month, year, snap_CA, snap_TX, snap_WI, weekday_encoded, event_name_1_encoded, event_type_1_encoded...
2025-07-20 21:40:07,903 - features.feature_engineering - INFO - Data types: {dtype('float32'): 122}
2025-07-20 21:40:07,904 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:40:08,020 - features.feature_engineering - INFO - Final feature set: 122 features
2025-07-20 21:40:08,020 - features.feature_engineering - INFO - Features: day_num, wday, month, year, snap_CA, snap_TX, snap_WI, weekday_encoded, event_name_1_encoded, event_type_1_encoded...
2025-07-20 21:40:08,021 - features.feature_engineering - INFO - Data types: {dtype('float32'): 122}
2025-07-20 21:40:08,021 - __main__ - INFO - Model data prepared:
2025-07-20 21:40:08,022 - __main__ - INFO -   Features: 122
2025-07-20 21:40:08,022 - __main__ - INFO -   Train samples: 45000
2025-07-20 21:40:08,022 - __main__ - INFO -   Val samples: 28000
2025-07-20 21:40:08,022 - __main__ - INFO -   Test samples: 28000
2025-07-20 21:40:08,022 - __main__ - INFO - Step 5: Training models...
2025-07-20 21:40:08,022 - __main__ - INFO - Training models: ['lightgbm', 'xgboost']
2025-07-20 21:40:08,023 - __main__ - INFO - Training lightgbm...
2025-07-20 21:40:08,023 - models.ml_models - INFO - Training lightgbm...
2025-07-20 21:40:08,023 - models.ml_models - INFO - Training lightgbm with shape (45000, 122)
2025-07-20 21:40:11,523 - models.ml_models - INFO - LightGBM training completed. Best iteration: 310
2025-07-20 21:40:11,526 - models.ml_models - INFO - lightgbm training completed in 3.50 seconds
2025-07-20 21:40:11,526 - __main__ - INFO - Training xgboost...
2025-07-20 21:40:11,526 - models.ml_models - INFO - Training xgboost...
2025-07-20 21:40:11,526 - models.ml_models - INFO - Training xgboost with shape (45000, 122)
2025-07-20 21:40:11,526 - __main__ - ERROR - Pipeline failed: XGBModel.fit() got an unexpected keyword argument 'early_stopping_rounds'
2025-07-20 21:40:11,526 - __main__ - ERROR - Training failed: XGBModel.fit() got an unexpected keyword argument 'early_stopping_rounds'
2025-07-20 21:42:28,757 - __main__ - INFO - Starting M5 Demand Forecasting Training Pipeline
2025-07-20 21:42:28,758 - __main__ - INFO - ============================================================
2025-07-20 21:42:28,758 - __main__ - INFO - Step 1: Loading data...
2025-07-20 21:42:28,758 - __main__ - INFO - Loading M5 competition data...
2025-07-20 21:42:28,759 - __main__ - INFO - Found data files in: src\data\raw
2025-07-20 21:42:28,759 - __main__ - INFO - Loading sales data...
2025-07-20 21:42:31,202 - __main__ - INFO - Converting sales data to long format...
2025-07-20 21:43:24,902 - __main__ - INFO - Loading calendar and prices data...
2025-07-20 21:43:26,504 - __main__ - INFO - Data loaded successfully!
2025-07-20 21:43:26,505 - __main__ - INFO - Sales shape: (58327370, 9)
2025-07-20 21:43:26,505 - __main__ - INFO - Calendar shape: (1969, 14)
2025-07-20 21:43:26,505 - __main__ - INFO - Prices shape: (6841121, 4)
2025-07-20 21:43:26,530 - __main__ - INFO - Step 2: Creating features...
2025-07-20 21:43:26,530 - __main__ - INFO - Creating features...
2025-07-20 21:43:26,531 - __main__ - INFO - Quick test mode - using subset of data
2025-07-20 21:43:26,954 - features.feature_engineering - INFO - Creating comprehensive feature set...
2025-07-20 21:43:26,960 - features.feature_engineering - INFO - Merging calendar data...
2025-07-20 21:43:27,150 - features.feature_engineering - INFO - Merging pricing data...
2025-07-20 21:43:28,481 - features.feature_engineering - INFO - Creating temporal features...
2025-07-20 21:43:28,537 - features.feature_engineering - INFO - Creating lag features...
2025-07-20 21:43:43,336 - features.feature_engineering - INFO - Creating rolling window features...
2025-07-20 21:43:43,986 - features.feature_engineering - INFO - Creating demand pattern features...
2025-07-20 21:45:12,300 - features.feature_engineering - INFO - Creating price features...
2025-07-20 21:45:12,537 - features.feature_engineering - INFO - Creating categorical features...
2025-07-20 21:45:12,842 - features.feature_engineering - INFO - Creating business logic features...
2025-07-20 21:45:44,607 - features.feature_engineering - INFO - Creating interaction features...
2025-07-20 21:45:44,679 - features.feature_engineering - INFO - Creating event features...
2025-07-20 21:45:44,792 - features.feature_engineering - INFO - Feature engineering complete. Shape: (101000, 132)
2025-07-20 21:45:44,792 - __main__ - INFO - Features created. Shape: (101000, 132)
2025-07-20 21:45:49,819 - __main__ - INFO - Features saved to data\features\feature_store.csv
2025-07-20 21:45:49,821 - __main__ - INFO - Step 3: Splitting data...
2025-07-20 21:45:49,822 - __main__ - INFO - Splitting data for time series validation...
2025-07-20 21:45:49,995 - __main__ - INFO - Data split completed:
2025-07-20 21:45:49,996 - __main__ - INFO -   Train: (45000, 132) (2016-01-15 00:00:00 to 2016-02-28 00:00:00)
2025-07-20 21:45:49,997 - __main__ - INFO -   Val:   (28000, 132) (2016-02-29 00:00:00 to 2016-03-27 00:00:00)
2025-07-20 21:45:49,997 - __main__ - INFO -   Test:  (28000, 132) (2016-03-28 00:00:00 to 2016-04-24 00:00:00)
2025-07-20 21:45:50,007 - __main__ - INFO - Step 4: Preparing model data...
2025-07-20 21:45:50,007 - __main__ - INFO - Preparing data for modeling...
2025-07-20 21:45:50,008 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:45:50,179 - features.feature_engineering - INFO - Final feature set: 122 features
2025-07-20 21:45:50,180 - features.feature_engineering - INFO - Features: day_num, wday, month, year, snap_CA, snap_TX, snap_WI, weekday_encoded, event_name_1_encoded, event_type_1_encoded...
2025-07-20 21:45:50,181 - features.feature_engineering - INFO - Data types: {dtype('float32'): 122}
2025-07-20 21:45:50,181 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:45:50,300 - features.feature_engineering - INFO - Final feature set: 122 features
2025-07-20 21:45:50,301 - features.feature_engineering - INFO - Features: day_num, wday, month, year, snap_CA, snap_TX, snap_WI, weekday_encoded, event_name_1_encoded, event_type_1_encoded...
2025-07-20 21:45:50,302 - features.feature_engineering - INFO - Data types: {dtype('float32'): 122}
2025-07-20 21:45:50,302 - features.feature_engineering - INFO - Preparing features for modeling...
2025-07-20 21:45:50,414 - features.feature_engineering - INFO - Final feature set: 122 features
2025-07-20 21:45:50,415 - features.feature_engineering - INFO - Features: day_num, wday, month, year, snap_CA, snap_TX, snap_WI, weekday_encoded, event_name_1_encoded, event_type_1_encoded...
2025-07-20 21:45:50,416 - features.feature_engineering - INFO - Data types: {dtype('float32'): 122}
2025-07-20 21:45:50,416 - __main__ - INFO - Model data prepared:
2025-07-20 21:45:50,417 - __main__ - INFO -   Features: 122
2025-07-20 21:45:50,417 - __main__ - INFO -   Train samples: 45000
2025-07-20 21:45:50,418 - __main__ - INFO -   Val samples: 28000
2025-07-20 21:45:50,418 - __main__ - INFO -   Test samples: 28000
2025-07-20 21:45:50,418 - __main__ - INFO - Step 5: Training models...
2025-07-20 21:45:50,418 - __main__ - INFO - Training models: ['lightgbm', 'xgboost']
2025-07-20 21:45:50,419 - __main__ - INFO - Training lightgbm...
2025-07-20 21:45:50,419 - models.ml_models - INFO - Training lightgbm...
2025-07-20 21:45:50,419 - models.ml_models - INFO - Training lightgbm with shape (45000, 122)
2025-07-20 21:45:54,175 - models.ml_models - INFO - LightGBM training completed. Best iteration: 310
2025-07-20 21:45:54,178 - models.ml_models - INFO - lightgbm training completed in 3.76 seconds
2025-07-20 21:45:54,178 - __main__ - INFO - Training xgboost...
2025-07-20 21:45:54,179 - models.ml_models - INFO - Training xgboost...
2025-07-20 21:45:54,179 - models.ml_models - INFO - Training xgboost with shape (45000, 122)
2025-07-20 21:45:59,722 - models.ml_models - INFO - XGBoost training completed
2025-07-20 21:45:59,723 - models.ml_models - INFO - xgboost training completed in 5.54 seconds
2025-07-20 21:45:59,723 - __main__ - INFO - Step 6: Creating ensemble...
2025-07-20 21:45:59,723 - __main__ - INFO - Creating ensemble model...
2025-07-20 21:45:59,723 - models.ml_models - INFO - Ensemble created with models: ['lightgbm', 'xgboost']
2025-07-20 21:45:59,723 - __main__ - INFO - Step 7: Evaluating models...
2025-07-20 21:45:59,724 - __main__ - INFO - Evaluating models...
2025-07-20 21:45:59,724 - __main__ - INFO - Evaluating lightgbm...
2025-07-20 21:45:59,822 - __main__ - INFO - Evaluating xgboost...
2025-07-20 21:45:59,917 - __main__ - INFO - Evaluating ensemble...
2025-07-20 21:46:00,064 - __main__ - INFO - Step 8: Saving results...
2025-07-20 21:46:00,064 - __main__ - INFO - Saving results...
2025-07-20 21:46:00,108 - models.ml_models - INFO - Model saved to models\trained\lightgbm.joblib
2025-07-20 21:46:00,159 - models.ml_models - INFO - Model saved to models\trained\xgboost.joblib
2025-07-20 21:46:00,251 - models.ml_models - INFO - Models saved to models\trained
2025-07-20 21:46:00,260 - __main__ - INFO - Results saved to outputs\training_results.json
2025-07-20 21:46:00,260 - __main__ - INFO - Training pipeline completed successfully!
2025-07-20 21:46:00,260 - __main__ - INFO - ============================================================
